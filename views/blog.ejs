<!DOCTYPE html>
<html lang="en">
  <head>
    <%- include("./partials/head") %>
    <title><%= blog.title %></title>
    <style>
      body {
        font-family: 'Poppins', sans-serif;
        background-color: #f4f6f8;
      }

      .blog-card {
        background: #ffffff;
        border-radius: 12px;
        box-shadow: 0 6px 15px rgba(0,0,0,0.1);
        padding: 2rem;
        margin-bottom: 2rem;
      }

      .blog-card img {
        max-width: 100%;
        border-radius: 12px;
        margin-bottom: 1rem;
      }

      .author {
        display: flex;
        align-items: center;
        margin-top: 1rem;
      }

      .author img {
        border-radius: 50%;
        margin-right: 1rem;
        width: 60px;
        height: 60px;
        object-fit: cover;
      }

      .comments-section {
        margin-top: 2rem;
      }

      .comment-card {
        background: #ffffff;
        padding: 1rem;
        border-radius: 8px;
        box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        margin-bottom: 1rem;
        display: flex;
        align-items: flex-start;
        gap: 1rem;
      }

      .comment-card img {
        border-radius: 50%;
        width: 50px;
        height: 50px;
        object-fit: cover;
      }

      .comment-content {
        flex: 1;
      }

      .comment-form input {
        border-radius: 8px;
        padding: 0.75rem;
      }

      .comment-form button {
        border-radius: 8px;
        padding: 0.5rem 1rem;
      }
    </style>
  </head>
  <body>
    <%- include("./partials/nav") %>

    <div class="container mt-4 blog-card">
      <h1><%= blog.title %></h1>
      <img src="<%= blog.coverImageURL %>" alt="Blog Image" />
      <pre class="mt-3"><%= blog.body %></pre>

      <div class="author">
        <img src="<%= blog.createdBy.profileImageURL %>" alt="User Profile" />
        <strong><%= blog.createdBy.fullName %></strong>
      </div>
    </div>

    <div class="container comments-section">
      <h3>Comments (<%= comments.length %>)</h3>

      <% if (locals.user) { %>
      <form class="comment-form mb-3" action="/blog/comment/<%= blog._id %>" method="POST">
        <div class="mb-2">
          <input
            type="text"
            class="form-control"
            name="content"
            placeholder="Add your comment..."
            required
          />
        </div>
        <button type="submit" class="btn btn-primary btn-sm">Add Comment</button>
      </form>
      <% } %>

      <div>
        <% comments.forEach(comment => { %>
        <div class="comment-card">
          <img src="/images/user.jpg" alt="User Profile" />
          <div class="comment-content">
            <strong><%= comment.createdBy.fullName %></strong>
            <pre><%= comment.content %></pre>
          </div>
        </div>
        <% }) %>
      </div>
    </div>

    <%- include("./partials/script") %>
  </body>
</html>
